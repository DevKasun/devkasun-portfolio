---
import { Image } from 'astro:assets';
import PageLayout from '../layouts/PageLayout.astro';
import linkIcon from '../assets/icons/arrow-up-right.svg';
import workPageImage from '../../public/work.png';
import projectPortfolio from '../assets/images/projects/project-portfolio.png';
import projectLiquidX from '../assets/images/projects/liquid-x.png';

import { WORK_SITE_TITLE, WORK_SITE_DESCRIPTION } from '../consts';
---

<PageLayout title={WORK_SITE_TITLE} description={WORK_SITE_DESCRIPTION}>
	<main class='about py-28'>
		<section class='pb-14'>
			<div class='container mx-auto px-8'>
				<div class='flex flex-col gap-8 pb-8 lg:grid lg:grid-cols-5'>
					<div class='col-span-2'>
						<Image
							src={workPageImage}
							width={1280}
							height={720}
							alt='developer_image'
							decoding='async'
							loading='lazy'
							class='work-image'
						/>
						<h2 class='work-title text-4xl py-6'>My Work</h2>
					</div>
					<div class='col-span-3 flex flex-col gap-4'>
						<div
							class='project-card flex flex-col md:grid grid-cols-3 gap-8 rounded p-4 bg-kgreen/20 trasition-background duration-300 ease-in-out hover:bg-kgreen/40'
						>
							<Image
								src={projectPortfolio}
								class='project-image rounded object-cover h-[125px]'
								width={1280}
								height={720}
								alt='developer_image'
								decoding='async'
								loading='lazy'
							/>
							<div class='col-span-2 flex flex-col gap-4'>
								<h3
									class='project-title text-xl md:text-2xl flex gap-2 items-center mx-1'
								>
									Portfolio website
									<a
										target='_blank'
										href='https://www.devkasun.me/'
									>
										<Image
											src={linkIcon}
											class='rounded'
											width={24}
											height={24}
											alt='developer_image'
											decoding='async'
											loading='lazy'
										/>
									</a>
								</h3>
								<div>
									<p class='mx-1 text-sm'>Tech Stack:</p>
									<div class='tech-stack-container flex flex-wrap'>
										<span class='tech-stack'>Astro</span>
										<span class='tech-stack'>TailwindCSS</span>
										<span class='tech-stack'>pnpm</span>
										<span class='tech-stack'>Vercel</span>
									</div>
								</div>
							</div>
						</div>
						<div
							class='project-card flex flex-col md:grid grid-cols-3 gap-8 rounded p-4 bg-kgreen/20 trasition-background duration-300 ease-in-out hover:bg-kgreen/40'
						>
							<Image
								src={projectLiquidX}
								class='project-image rounded object-cover h-[125px]'
								width={1280}
								height={720}
								alt='developer_image'
								decoding='async'
								loading='lazy'
							/>
							<div class='col-span-2 flex flex-col gap-4'>
								<h3
									class='project-title text-xl md:text-2xl flex gap-2 items-center mx-1'
								>
									Liquid X (Glassmorphism UI)
									<a
										target='_blank'
										href='https://liquid-x-ten.vercel.app/'
									>
										<Image
											src={linkIcon}
											class='rounded'
											width={24}
											height={24}
											alt='developer_image'
											decoding='async'
											loading='lazy'
										/>
									</a>
								</h3>
								<div>
									<p class='mx-1 text-sm'>Tech Stack:</p>
									<div class='tech-stack-container flex flex-wrap'>
										<span class='tech-stack'>Vue</span>
										<span class='tech-stack'>SCSS</span>
										<span class='tech-stack'>Bun</span>
										<span class='tech-stack'>Vercel</span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				
			</div>
		</section>
	</main>
</PageLayout>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
<script is:inline>
	document.addEventListener('DOMContentLoaded', () => {
		if (typeof gsap !== 'undefined') {
			gsap.registerPlugin(ScrollTrigger);
			
			const tl = gsap.timeline();

			// Set initial states
			gsap.set('.work-image', { 
				scale: 0.8, 
				opacity: 0,
				y: 50
			});
			
			gsap.set('.work-title', { 
				x: -50, 
				opacity: 0 
			});
			
			gsap.set('.project-card', { 
				y: 100, 
				opacity: 0 
			});

			// Animation sequence
			tl.to('.work-image', {
				scale: 1,
				opacity: 1,
				y: 0,
				duration: 1,
				ease: 'power2.out',
			})
			.to('.work-title', {
				x: 0,
				opacity: 1,
				duration: 0.8,
				ease: 'power2.out',
			}, '-=0.5')
			.to('.project-card', {
				y: 0,
				opacity: 1,
				duration: 0.8,
				ease: 'power2.out',
				stagger: 0.2
			}, '-=0.3');

			// Hover animations for project cards
			const projectCards = document.querySelectorAll('.project-card');
			
			projectCards.forEach(card => {
				const projectImage = card.querySelector('.project-image');
				const projectTitle = card.querySelector('.project-title');
				const techStacks = card.querySelectorAll('.tech-stack');
				
				card.addEventListener('mouseenter', () => {
					gsap.to(projectImage, {
						scale: 1.05,
						duration: 0.3,
						ease: 'power2.out'
					});
					
					gsap.to(projectTitle, {
						x: 5,
						duration: 0.3,
						ease: 'power2.out'
					});
					
					gsap.to(techStacks, {
						y: -3,
						duration: 0.3,
						ease: 'power2.out',
						stagger: 0.05
					});
				});
				
				card.addEventListener('mouseleave', () => {
					gsap.to(projectImage, {
						scale: 1,
						duration: 0.3,
						ease: 'power2.out'
					});
					
					gsap.to(projectTitle, {
						x: 0,
						duration: 0.3,
						ease: 'power2.out'
					});
					
					gsap.to(techStacks, {
						y: 0,
						duration: 0.3,
						ease: 'power2.out',
						stagger: 0.05
					});
				});
			});

			// Scroll-triggered animations for tech stacks
			gsap.utils.toArray('.tech-stack-container').forEach(container => {
				const techStacks = container.querySelectorAll('.tech-stack');
				
				gsap.fromTo(techStacks, {
					scale: 0.8,
					opacity: 0.3
				}, {
					scale: 1,
					opacity: 1,
					duration: 0.5,
					ease: 'back.out(1.7)',
					stagger: 0.1,
					scrollTrigger: {
						trigger: container,
						start: 'top 80%',
						end: 'bottom 20%',
						toggleActions: 'play none none reverse'
					}
				});
			});
		}
	});
</script>
